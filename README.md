# Terraform Yandex Service Account module

A terraform module to create a service account on Yandex Cloud. Module will manage

* service account,
* bindings to roles in the folder,
* static access key of account,
* service account key of account. 

## Example usage

```terraform
module "storage_admin" {
  source  = "gitlab.com/tf-org-ru/service-account/yandex"
  version = "~> 1.0" 

  name              = "storage-admin"
  roles             = ["storage.admin"]
  static_access_key = true
}

module "backup_sa" {
  source  = "gitlab.com/tf-org-ru/service-account/yandex"
  version = "~> 1.0"

  name                = "backup"
  service_account_key = true
}

resource "yandex_storage_bucket" "default" {
  access_key = module.storage_admin.access_key
  secret_key = module.storage_admin.secret_key

  bucket = "backups"

  grant {
    type        = "CanonicalUser"
    id          = module.backup_sa.id
    permissions = ["READ", "WRITE"]
  }
}

output "backup_sa_key" {
  value = module.backup_sa.service_account_key
}
```
<!-- BEGIN_TF_DOCS -->
## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_description"></a> [description](#input\_description) | Description of the service account. | `string` | `"Managed by terraform"` | no |
| <a name="input_folder_id"></a> [folder\_id](#input\_folder\_id) | ID of the folder that the service account will be created in. Defaults to the provider folder configuration. | `string` | `null` | no |
| <a name="input_name"></a> [name](#input\_name) | Name of the service account | `string` | n/a | yes |
| <a name="input_roles"></a> [roles](#input\_roles) | Roles of the service account in the folder. | `set(string)` | `[]` | no |
| <a name="input_service_account_key"></a> [service\_account\_key](#input\_service\_account\_key) | Whether to create [service account authorized key](https://cloud.yandex.com/docs/iam/concepts/authorization/key). | `bool` | `false` | no |
| <a name="input_static_access_key"></a> [static\_access\_key](#input\_static\_access\_key) | Whether to create [service account static access key](https://cloud.yandex.com/docs/iam/operations/sa/create-access-key). | `bool` | `false` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_access_key"></a> [access\_key](#output\_access\_key) | ID of the static access key or `null` if `static_access_key` was not set to true. |
| <a name="output_id"></a> [id](#output\_id) | ID of the service account |
| <a name="output_secret_key"></a> [secret\_key](#output\_secret\_key) | Private part of generated static access key or `null` if `static_access_key` was not set to true. |
| <a name="output_service_account_key"></a> [service\_account\_key](#output\_service\_account\_key) | JSON representation of service account key as generated by `yc iam key create --output key.json`. Or `null` if `service_account_key` was not set to true. |
<!-- END_TF_DOCS -->